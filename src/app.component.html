
<div class="min-h-screen bg-green-50 text-gray-800 font-sans flex flex-col items-center p-4 sm:p-8">
  <header class="text-center mb-6 sm:mb-10">
    <h1 class="text-4xl sm:text-5xl font-bold text-green-800 font-serif flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mr-3 text-green-500" viewBox="0 0 20 20" fill="currentColor">
        <path d="M17.742 2.258a1.5 1.5 0 00-2.121 0l-9.25 9.25a1.5 1.5 0 000 2.121l9.25 9.25a1.5 1.5 0 002.121-2.121L9.621 12l8.121-8.121a1.5 1.5 0 000-2.121zM2.258 11.47a1.5 1.5 0 000-2.121L11.508.1a1.5 1.5 0 00-2.121 2.121L3.379 10.38l8.122 8.12a1.5 1.5 0 002.121-2.12L4.38 11.47a1.5 1.5 0 00-2.121 0z" />
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM2 10a8 8 0 1116 0 8 8 0 01-16 0z" clip-rule="evenodd" />
        <path d="M15.53 4.47a.75.75 0 00-1.06 0L10 8.94 5.53 4.47a.75.75 0 10-1.06 1.06L8.94 10l-4.47 4.47a.75.75 0 101.06 1.06L10 11.06l4.47 4.47a.75.75 0 101.06-1.06L11.06 10l4.47-4.47a.75.75 0 000-1.06z" />
        <path d="M10 18a.75.75 0 01-.75-.75V2.75a.75.75 0 011.5 0v14.5A.75.75 0 0110 18z" />
      </svg>
      Dream Garden Designer
    </h1>
    <p class="mt-2 text-lg text-green-700">Craft your personal paradise with the power of AI.</p>
  </header>

  <main class="w-full max-w-4xl bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-6 sm:p-8 border border-green-200">

    @if (isLoading()) {
      <div class="flex flex-col items-center justify-center h-96">
        <svg class="animate-spin h-12 w-12 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <p class="text-green-700 font-medium mt-4 text-lg text-center">{{ loadingMessage() }}</p>
      </div>
    } @else {
      @if (error()) {
        <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg mb-6" role="alert">
          <p class="font-bold">An error occurred</p>
          <p>{{ error() }}</p>
        </div>
      }

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
        <!-- Left Side: Image Display -->
        <div class="w-full">
          @if (displayImage()) {
            <div class="aspect-square bg-gray-200 rounded-xl shadow-inner overflow-hidden border-4 border-white ring-1 ring-gray-200">
              <img [src]="displayImage()" alt="Generated or uploaded garden" class="w-full h-full object-cover transition-opacity duration-500 animate-[fadeIn_0.5s_ease-in-out]">
            </div>
          } @else {
            <div class="aspect-square bg-green-100 rounded-xl shadow-inner flex flex-col items-center justify-center text-center p-4 border-2 border-dashed border-green-300">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              <h3 class="font-semibold text-green-800">Your Garden Awaits</h3>
              <p class="text-sm text-green-600">Describe your vision or upload a photo to begin.</p>
            </div>
          }
        </div>

        <!-- Right Side: Controls -->
        <div class="flex flex-col gap-6">
          @if (!displayImage()) {
            <div>
              <label for="prompt" class="block text-lg font-semibold text-green-800 mb-2">Describe Your Dream Garden</label>
              <textarea id="prompt" name="prompt" [(ngModel)]="prompt" rows="5" class="w-full p-3 border border-green-300 rounded-lg shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white transition-shadow" placeholder="e.g., a serene Japanese zen garden with a koi pond and cherry blossoms..."></textarea>
              <button (click)="generateGarden()" [disabled]="!prompt()" class="w-full mt-4 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v1h-2V4H7v1H5V4zM5 7h10v9a2 2 0 01-2 2H7a2 2 0 01-2-2V7z" /></svg>
                Generate Garden
              </button>
            </div>
            <div class="relative">
              <div class="absolute inset-0 flex items-center" aria-hidden="true"><div class="w-full border-t border-gray-300"></div></div>
              <div class="relative flex justify-center"><span class="bg-white/80 px-2 text-sm text-gray-500">Or</span></div>
            </div>
            <div>
              <label for="file-upload" class="w-full cursor-pointer bg-white hover:bg-gray-50 text-green-700 font-bold py-3 px-6 rounded-lg shadow-md border border-gray-300 transition-colors flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L6.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg>
                Upload a Photo
              </label>
              <input id="file-upload" name="file-upload" type="file" class="sr-only" (change)="onFileSelected($event)" accept="image/png, image/jpeg, image/webp">
            </div>
          } @else {
            <div>
              <label for="edit-prompt" class="block text-lg font-semibold text-green-800 mb-2">Refine Your Vision</label>
              <textarea id="edit-prompt" name="editPrompt" [(ngModel)]="editPrompt" rows="3" class="w-full p-3 border border-green-300 rounded-lg shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white transition-shadow" placeholder="e.g., add a rustic stone pathway, make it evening with fairy lights..."></textarea>
              <button (click)="applyEdit()" [disabled]="!editPrompt()" class="w-full mt-4 bg-lime-600 hover:bg-lime-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                Apply Edit
              </button>
            </div>
            <div>
              <button (click)="reset()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 px-6 rounded-lg shadow-sm border border-gray-300 transition-colors flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.898 2.182.75.75 0 01-1.061 1.061A5.501 5.501 0 005.5 8.153V10a1 1 0 01-2 0V3a1 1 0 011-1zm12 4.101a1 1 0 01-1-1V3a1 1 0 012 0v2.153a5.501 5.501 0 00-9.337 4.545.75.75 0 01-1.061-1.061A7.002 7.002 0 0115 5.101V3a1 1 0 011-1z" clip-rule="evenodd" /></svg>
                Start Over
              </button>
            </div>
          }
        </div>
      </div>
    }
  </main>
</div>
